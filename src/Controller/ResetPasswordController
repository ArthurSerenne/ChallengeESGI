use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\Routing\Annotation\Route;
use Symfony\Component\Mailer\MailerInterface;
use Symfony\Component\Mime\Email;

class ResetPasswordController extends AbstractController
{
    /**
     * @Route("/reset-password", name="reset_password_request")
     */
    public function request(Request $request, MailerInterface $mailer)
    {
        // Récupérer l'email de l'utilisateur depuis le formulaire
        $email = $request->request->get('email');

        // Générer un token sécurisé (à stocker en base de données)
        $token = bin2hex(random_bytes(32));

        // Envoyer l'email de réinitialisation
        $email = (new Email())
            ->from('noreply@votredomaine.com')
            ->to($email)
            ->subject('Réinitialisation de mot de passe')
            ->html($this->renderView('emails/reset_password.html.twig', [
                'token' => $token,
            ]));

        $mailer->send($email);

        // Redirection vers une page de confirmation ou autre
        return $this->redirectToRoute('homepage');
    }
}
